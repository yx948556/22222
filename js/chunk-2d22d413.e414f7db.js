(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d413"],{f75a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/login/user"}}},[e._v("用户首页")]),a("el-breadcrumb-item",[e._v("商品管理")]),a("el-breadcrumb-item",[e._v("分类列表")])],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"always"}},[a("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.showCateForm}},[e._v("添加分类")])],1)],1),a("zk-table",{attrs:{data:e.goodsList,columns:e.columns,"selection-type":!1,"expand-type":!1,"show-index":"","index-text":"#",border:""},scopedSlots:e._u([{key:"likes",fn:function(e){return[!1===e.row.cat_deleted?a("i",{staticClass:"el-icon-success",staticStyle:{color:"green"}}):a("i",{staticClass:"el-icon-error",staticStyle:{color:"red"}})]}},{key:"order",fn:function(t){return[0===t.row.cat_level?a("el-tag",[e._v("一级")]):1===t.row.cat_level?a("el-tag",{attrs:{type:"success"}},[e._v("二级")]):a("el-tag",{attrs:{type:"warning"}},[e._v("三级")])]}},{key:"active",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"}},[e._v("删除")])]}}])}),a("el-pagination",{attrs:{"current-page":e.cateList.pagenum,"page-sizes":[5,8,16,20],"page-size":e.cateList.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"分配分类",visible:e.cateShow},on:{"update:visible":function(t){e.cateShow=t},close:e.addCrteClose}},[a("el-form",{ref:"addCateFormRef",attrs:{model:e.addCateForm,rules:e.addCateFormRules}},[a("el-form-item",{attrs:{label:"分类名称",prop:"cat_name","label-width":"80px"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addCateForm.cat_name,callback:function(t){e.$set(e.addCateForm,"cat_name",t)},expression:"addCateForm.cat_name"}})],1),a("el-form-item",{attrs:{label:"父级分类","label-width":"80px"}},[a("el-cascader",{attrs:{options:e.parentList,"expand-trigger":"hover",props:e.cateProps,clearable:"","change-on-select":""},on:{change:e.panterChange},model:{value:e.selectKeys,callback:function(t){e.selectKeys=t},expression:"selectKeys"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cateShow=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addCrte}},[e._v("确 定")])],1)],1)],1)},o=[],i={data(){return{goodsList:[],cateList:{type:"3",pagesize:5,pagenum:1},total:0,columns:[{label:"分类名称",prop:"cat_name"},{label:"是否有效",type:"template",template:"likes"},{label:"排序",type:"template",template:"order"},{label:"操作",type:"template",template:"active"}],cateShow:!1,addCateForm:{cat_pid:0,cat_name:"",cat_level:0},parentList:[],cateProps:{value:"cat_id",label:"cat_name",children:"children"},selectKeys:[],addCateFormRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}]}}},created(){},mounted(){this.getGoodsList()},methods:{async getGoodsList(){const{data:e}=await this.$axios.get("https://www.liulongbin.top:8888/api/private/v1/categories",{params:this.cateList});console.log(e),200==e.meta.status?(this.$message.success(e.meta.msg),this.goodsList=e.data.result,this.total=e.data.total,console.log()):this.$message.error(e.meta.msg)},showCateForm(){this.getPanterId(),this.cateShow=!0},getPanterId(){this.$axios.get("https://www.liulongbin.top:8888/api/private/v1/categories",{params:{type:2}}).then(e=>{console.log(e.data.data),200==e.data.meta.status?(this.$message.success("获取父类分配ID成功"),this.parentList=e.data.data):this.$message.error("获取父类分类ID失败")})},panterChange(){if(console.log(this.selectKeys),this.selectKeys.length>0)return this.addCateForm.cat_pid=this.selectKeys[this.selectKeys.length-1],void(this.addCateForm.cat_level=this.selectKeys.length);this.addCateForm.cat_pid=0,this.addCateForm.cat_level=0},addCrte(){console.log(this.addCateForm),this.$refs.addCateFormRef.validate(e=>{e&&this.$axios.post("https://www.liulongbin.top:8888/api/private/v1/categories",this.addCateForm).then(e=>{console.log(e),201==e.data.meta.status?(this.$message.success(e.data.meta.msg),this.getGoodsList(),this.cateShow=!1):this.$message.error(e.data.meta.msg)})})},addCrteClose(){this.$refs.addCateFormRef.resetFields(),this.selectKeys=[],this.addCateForm.cat_pid=0,this.addCateForm.cat_level=0},handleSizeChange(e){console.log(e),this.cateList.pagesize=e,this.getGoodsList()},handleCurrentChange(e){console.log(e),this.cateList.pagenum=e,this.getGoodsList()}},computed:{},components:{}},l=i,r=a("2877"),n=Object(r["a"])(l,s,o,!1,null,"84517c54",null);t["default"]=n.exports}}]);