(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-182f2f8e"],{"08b6":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/login/user"}}},[e._v("用户首页")]),s("el-breadcrumb-item",[e._v("用户列表")])],1),s("el-form",{staticStyle:{"margin-top":"15px"},attrs:{inline:!0}},[s("el-form-item",[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加用户")])],1)],1),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList}},[s("el-table-column",{attrs:{prop:"id",label:"ID",width:"180"}}),s("el-table-column",{attrs:{prop:"username",label:"姓名",width:"180"}}),s("el-table-column",{attrs:{prop:"mobile",label:"电话",width:"150"}}),s("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"150"}}),s("el-table-column",{attrs:{prop:"role_name",label:"角色",width:"100"}}),s("el-table-column",{attrs:{prop:"mg_state",label:"角色状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#eaeaea"},on:{change:function(s){return e.roleState(t.row)}},model:{value:t.row.mg_state,callback:function(s){e.$set(t.row,"mg_state",s)},expression:"scope.row.mg_state"}})]}}])}),s("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-edit i",staticStyle:{},on:{click:function(s){return e.changeuser(t.row)}}}),s("i",{staticClass:"el-icon-delete i",on:{click:function(s){return e.del(t.row.id)}}}),s("i",{staticClass:"el-icon-setting i",on:{click:function(s){return e.addRole(t.row)}}})]}}])})],1),s("el-pagination",{attrs:{"current-page":this.pagenum,"page-sizes":[2,4,6,8],"page-size":this.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),s("el-dialog",{attrs:{title:"添加用户",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{attrs:{model:e.addUser,rules:e.loginRules}},[s("el-form-item",{attrs:{label:"姓名","label-width":"80px",prop:"username"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.addUser.username,callback:function(t){e.$set(e.addUser,"username",t)},expression:"addUser.username"}})],1),s("el-form-item",{attrs:{label:"密码","label-width":"80px",prop:"password"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.addUser.password,callback:function(t){e.$set(e.addUser,"password",t)},expression:"addUser.password"}})],1),s("el-form-item",{attrs:{label:"电话","label-width":"80px",prop:"mobile"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.addUser.mobile,callback:function(t){e.$set(e.addUser,"mobile",t)},expression:"addUser.mobile"}})],1),s("el-form-item",{attrs:{label:"邮箱","label-width":"80px",prop:"email"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.addUser.email,callback:function(t){e.$set(e.addUser,"email",t)},expression:"addUser.email"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addUsers}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"编辑用户",visible:e.show},on:{"update:visible":function(t){e.show=t}}},[s("el-form",{attrs:{model:e.changeUser}},[s("el-form-item",{attrs:{label:"姓名","label-width":"80px"}},[s("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.changeUser.username,callback:function(t){e.$set(e.changeUser,"username",t)},expression:"changeUser.username"}})],1),s("el-form-item",{attrs:{label:"电话","label-width":"80px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.changeUser.mobile,callback:function(t){e.$set(e.changeUser,"mobile",t)},expression:"changeUser.mobile"}})],1),s("el-form-item",{attrs:{label:"邮箱","label-width":"80px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.changeUser.email,callback:function(t){e.$set(e.changeUser,"email",t)},expression:"changeUser.email"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.show=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.changeusers}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"分配角色",visible:e.showAddRole,width:"50%"},on:{"update:visible":function(t){e.showAddRole=t},close:e.inpNull}},[s("div",[s("p",[e._v("当前用户是:"+e._s(e.userInFor.username))]),s("p",[e._v("当前角色是:"+e._s(e.userInFor.role_name))]),s("p",[e._v(" 分配角色 "),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedRoleId,callback:function(t){e.selectedRoleId=t},expression:"selectedRoleId"}},e._l(e.roleList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showAddRole=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.saveRoleInfor}},[e._v("确 定")])],1)])],1)},l=[],o={data(){return{userList:[],query:"",pagesize:2,pagenum:1,total:0,dialogFormVisible:!1,addUser:{username:"",password:"",mobile:"",email:""},show:!1,changeUser:{username:"",mobile:"",email:""},cid:"",showAddRole:!1,userInFor:{},roleList:[],selectedRoleId:"",loginRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,max:10,message:"长度在 4 到 10 个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:11,max:11,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{min:4,max:15,message:"请输入正确的邮箱",trigger:"blur"}]}}},created(){},mounted(){this.getUserList()},methods:{async getUserList(){const{data:e}=await this.$axios.get(`https://www.liulongbin.top:8888/api/private/v1/users?query=${this.query}&pagesize=${this.pagesize}\n        &pagenum=${this.pagenum}`);console.log(e),200==e.meta.status?(this.$message.success(e.meta.msg),this.userList=e.data.users,this.total=e.data.total):this.$message.error(e.meta.msg)},async addUsers(){const{data:e}=await this.$axios.post("https://www.liulongbin.top:8888/api/private/v1/users",this.addUser);console.log(e),201==e.meta.status?(this.$message.success(e.meta.msg),this.dialogFormVisible=!1,this.getUserList()):this.$message.error(e.meta.msg)},changeuser(e){console.log(e),this.changeUser=e,this.cid=e.id,console.log(e.id),this.show=!0},async changeusers(){const{data:e}=await this.$axios.put("https://www.liulongbin.top:8888/api/private/v1/users/"+this.cid,this.changeUser);console.log(e),200==e.meta.status?(this.$message.success(e.meta.msg),this.show=!1,this.getUserList()):this.$message.error(e.meta.msg)},del(e){console.log(e),this.$confirm("你是不是真的要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.delete("https://www.liulongbin.top:8888/api/private/v1/users/"+e).then(e=>{console.log(e),200==e.data.meta.status?(this.$message.success(e.data.meta.msg),this.getUserList()):this.$message.error(e.data.meta.msg)})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},async roleState(e){console.log(e);const{data:t}=await this.$axios.put(`https://www.liulongbin.top:8888/api/private/v1/users/${e.id}/state/${e.mg_state}`);console.log(t),200==t.meta.status?this.$message.success(t.meta.msg):this.$message.error(t.meta.msg)},async addRole(e){this.userInFor=e;const{data:t}=await this.$axios.get("https://www.liulongbin.top:8888/api/private/v1/roles");console.log(t),200==t.meta.status?(this.$message.success(t.meta.msg),this.roleList=t.data,this.showAddRole=!0):this.$message.error(t.meta.msg)},async saveRoleInfor(){if(!this.selectedRoleId)return this.$message.error("请选择要分配的角色名称");const{data:e}=await this.$axios.put(`https://www.liulongbin.top:8888/api/private/v1/users/${this.userInFor.id}/role`,{rid:this.selectedRoleId});200==e.meta.status?(this.$message.success(e.meta.msg),this.getUserList(),this.showAddRole=!1):this.$message.error(e.meta.msg)},inpNull(){this.selectedRoleId="",this.userInFor={}},handleSizeChange(e){console.log(e),this.pagesize=e,this.getUserList()},handleCurrentChange(e){console.log(e),this.pagenum=e,this.getUserList()}},computed:{},components:{}},i=o,r=(s("dd1e"),s("2877")),n=Object(r["a"])(i,a,l,!1,null,"7e3b796a",null);t["default"]=n.exports},dd1e:function(e,t,s){"use strict";s("f517")},f517:function(e,t,s){}}]);